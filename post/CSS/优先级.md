# 优先级

当同一个元素被多个选择器选中并设置了相同的属性时，CSS 引擎通过计算“权重”（Specificity）来决定哪一个样式最终生效。

<div style="background-color: #e3f2fd; border-left: 5px solid #2196f3; padding: 15px; margin: 10px 0; color: #0d47a1;">
  <strong>计算核心</strong><br>
  浏览器会将选择器的权重相加。例如 <code>#nav .item</code> 的权重是 0100 + 0010 = 0110，高于单独的 <code>#nav</code> (0100)。
</div>

## 权重规则表

下表展示了不同层级的权重值（通常表示为四位数的等级）：

<div style="width: 100%; overflow-x: auto; margin: 20px 0;">
  <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd; font-family: sans-serif;">
    <thead>
      <tr style="background-color: #f2f2f2;">
        <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">层级</th>
        <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">权重值</th>
        <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">示例</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>!important</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px; color: #d32f2f; font-weight: bold;">最高</td>
        <td style="border: 1px solid #ddd; padding: 8px;"><code>color: red !important;</code></td>
      </tr>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>行内样式</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px; font-family: monospace;">1,0,0,0</td>
        <td style="border: 1px solid #ddd; padding: 8px;"><code>style="..."</code></td>
      </tr>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>ID 选择器</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px; font-family: monospace;">0,1,0,0</td>
        <td style="border: 1px solid #ddd; padding: 8px;"><code>#header</code></td>
      </tr>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>类 / 伪类 / 属性</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px; font-family: monospace;">0,0,1,0</td>
        <td style="border: 1px solid #ddd; padding: 8px;"><code>.box</code>, <code>:hover</code>, <code>[type="text"]</code></td>
      </tr>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>标签 / 伪元素</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px; font-family: monospace;">0,0,0,1</td>
        <td style="border: 1px solid #ddd; padding: 8px;"><code>div</code>, <code>::before</code></td>
      </tr>
      <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>通配符 / 继承</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px; font-family: monospace;">0,0,0,0</td>
        <td style="border: 1px solid #ddd; padding: 8px;"><code>*</code>, <code>body { ... }</code></td>
      </tr>
    </tbody>
  </table>
</div>

## 冲突演示

以下示例展示了一个元素被不同权重的选择器同时设置 `color` 属性时的最终结果。

<div style="border: 1px solid #ddd; border-radius: 4px; overflow: hidden; margin: 20px 0;">
  <div style="background-color: #f5f5f5; padding: 10px; border-bottom: 1px solid #ddd; font-family: Consolas, monospace; font-size: 14px; color: #333;">
    &lt;!-- CSS 源码 --&gt;<br>
    /* 1. 标签选择器 (0001) - 灰色 */<br>
    p { color: gray; }<br>
    <br>
    /* 2. 类选择器 (0010) - 蓝色 */<br>
    .text-blue { color: blue; }<br>
    <br>
    /* 3. ID 选择器 (0100) - 红色 */<br>
    #unique-text { color: red; }<br>
    <br>
    &lt;!-- HTML 源码 --&gt;<br>
    &lt;!-- 虽然类写在 ID 后面，但 ID 权重更高，所以显示红色 --&gt;<br>
    &lt;p id="unique-text" class="text-blue"&gt;<br>
    &nbsp;&nbsp;我是什么颜色？(ID > 类)<br>
    &lt;/p&gt;
  </div>
  <div style="padding: 20px; background-color: #fff;">
    <p style="color: red; font-weight: bold;">我是什么颜色？(ID > 类)</p>
  </div>
</div>

## 层叠与 Important

- **层叠原则**：当两个选择器的权重完全**相同**时，遵循“就近原则”，即**后定义**的样式会覆盖先定义的样式。
- **!important**：这是一个破坏性的规则，它可以强制让任何选择器的样式生效（即使是权重最低的标签选择器）。

<div style="border: 1px solid #ddd; border-radius: 4px; overflow: hidden; margin: 20px 0;">
  <div style="background-color: #f5f5f5; padding: 10px; border-bottom: 1px solid #ddd; font-family: Consolas, monospace; font-size: 14px; color: #333;">
    &lt;!-- CSS 源码 --&gt;<br>
    /* 权重 0010 */<br>
    .demo-box { background: silver; }<br>
    <br>
    /* 权重也是 0010，但写在后面，本应覆盖上面的 */<br>
    .demo-active { background: orange; }<br>
    <br>
    /* 使用 !important 强制生效，打破规则 */<br>
    .demo-important { background: purple !important; }<br>
    <br>
    &lt;!-- HTML --&gt;<br>
    &lt;div class="demo-box demo-active demo-important"&gt;Important 示例&lt;/div&gt;
  </div>
  <div style="padding: 20px; background-color: #fff;">
    <div style="background: purple; color: white; padding: 10px; border-radius: 4px;">Important 示例</div>
  </div>
</div>